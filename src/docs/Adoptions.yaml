paths:
  /api/adoptions:
    get:
      summary: Obtener todas las adopciones
      tags:
        - Adoptions
      description: Retorna la lista completa de adopciones registradas en el sistema
      responses:
        200:
          description: Lista de adopciones obtenida exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  payload:
                    type: array
                    items:
                      $ref: '#/components/schemas/Adoption'
        500:
          description: Error del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/adoptions/{aid}:
    get:
      summary: Obtener una adopción por ID
      tags:
        - Adoptions
      description: Retorna la información de una adopción específica
      parameters:
        - in: path
          name: aid
          required: true
          schema:
            type: string
          description: ID de la adopción
          example: 507f1f77bcf86cd799439011
      responses:
        200:
          description: Adopción encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  payload:
                    $ref: '#/components/schemas/Adoption'
        404:
          description: Adopción no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                status: error
                error:
                  code: ADOPTION_NOT_FOUND
                  message: Adoption record not found
        400:
          description: ID inválido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                status: error
                error:
                  code: INVALID_ID
                  message: Invalid ID format

  /api/adoptions/{uid}/{pid}:
    post:
      summary: Crear una nueva adopción
      tags:
        - Adoptions
      description: Registra una adopción vinculando un usuario con una mascota. Actualiza el estado de la mascota a adoptada y agrega la mascota al array de pets del usuario.
      parameters:
        - in: path
          name: uid
          required: true
          schema:
            type: string
          description: ID del usuario que adopta
          example: 507f1f77bcf86cd799439011
        - in: path
          name: pid
          required: true
          schema:
            type: string
          description: ID de la mascota a adoptar
          example: 507f1f77bcf86cd799439012
      responses:
        200:
          description: Adopción creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: Pet adopted
        400:
          description: Error en la validación
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalidParams:
                  value:
                    status: error
                    error:
                      code: ADOPTION_INVALID_PARAMS
                      message: Invalid adoption parameters. Required userId and petId
                alreadyAdopted:
                  value:
                    status: error
                    error:
                      code: PET_ALREADY_ADOPTED
                      message: This pet has already been adopted
                      details:
                        petId: 507f1f77bcf86cd799439012
        404:
          description: Usuario o mascota no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                userNotFound:
                  value:
                    status: error
                    error:
                      code: USER_NOT_FOUND
                      message: User not found
                petNotFound:
                  value:
                    status: error
                    error:
                      code: PET_NOT_FOUND
                      message: Pet not found

components:
  schemas:
    Adoption:
      type: object
      properties:
        _id:
          type: string
          description: ID único de la adopción
          example: 507f1f77bcf86cd799439011
        owner:
          type: string
          description: ID del usuario que adoptó
          example: 507f1f77bcf86cd799439012
        pet:
          type: string
          description: ID de la mascota adoptada
          example: 507f1f77bcf86cd799439013
      example:
        _id: 507f1f77bcf86cd799439011
        owner: 507f1f77bcf86cd799439012
        pet: 507f1f77bcf86cd799439013

    AdoptionPopulated:
      type: object
      description: Adopción con información completa de usuario y mascota
      properties:
        _id:
          type: string
          example: 507f1f77bcf86cd799439011
        owner:
          $ref: '#/components/schemas/User'
        pet:
          $ref: '#/components/schemas/Pet'

    User:
      type: object
      properties:
        _id:
          type: string
          example: 507f1f77bcf86cd799439012
        first_name:
          type: string
          example: Juan
        last_name:
          type: string
          example: Pérez
        email:
          type: string
          example: juan.perez@example.com
        role:
          type: string
          example: user
        pets:
          type: array
          items:
            type: object
            properties:
              _id:
                type: string
                example: 507f1f77bcf86cd799439013

    Pet:
      type: object
      properties:
        _id:
          type: string
          example: 507f1f77bcf86cd799439013
        name:
          type: string
          example: Firulais
        specie:
          type: string
          example: Dog
        birthDate:
          type: string
          format: date-time
          example: 2020-01-15T00:00:00.000Z
        adopted:
          type: boolean
          example: true
        owner:
          type: string
          example: 507f1f77bcf86cd799439012
        image:
          type: string
          example: /public/img/firulais.jpg

    Error:
      type: object
      properties:
        status:
          type: string
          example: error
        error:
          type: object
          properties:
            code:
              type: string
              example: ADOPTION_NOT_FOUND
            message:
              type: string
              example: Adoption record not found
            details:
              type: object
              description: Información adicional sobre el error